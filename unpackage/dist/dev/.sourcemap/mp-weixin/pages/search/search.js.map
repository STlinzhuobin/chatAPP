{"version":3,"sources":["webpack:///E:/项目/HBuilderProjects/社区交友/main.js","webpack:///E:/项目/HBuilderProjects/社区交友/pages/search/search.vue?bdd7","webpack:///E:/项目/HBuilderProjects/社区交友/pages/search/search.vue?cfac","webpack:///E:/项目/HBuilderProjects/社区交友/pages/search/search.vue?9cec","webpack:///E:/项目/HBuilderProjects/社区交友/pages/search/search.vue?58e8","webpack:///E:/项目/HBuilderProjects/社区交友/pages/search/search.vue"],"names":["createPage","Page","components","commonList","topicList","userList","loadMore","data","searchText","list","searchList","type","loadmore","page","onNavigationBarSearchInputChanged","e","text","onNavigationBarButtonTap","index","searchEvent","onLoad","pageTitle","uni","$on","follow","user_id","getStorageSync","JSON","parse","onUnload","$off","onPullDownRefresh","stopPullDownRefresh","getData","onReachBottom","methods","forEach","item","isFollow","showToast","title","doSupport","id","support","support_count","unsupport_count","msg","clickSearchHistory","hideKeyboard","findIndex","v","$U","__toFirst","unshift","setStorageSync","stringify","isrefresh","callback","showLoading","mask","$H","post","keyword","then","res","map","formatCommonList","cover","titlepic","desc","today_count","todaypost_count","news_count","post_count","avatar","userpic","username","sex","userinfo","age","length","hideLoading","catch","err"],"mappings":"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","file":"pages/search/search.js","sourcesContent":["import 'uni-pages';import '@dcloudio/uni-stat';\n\nimport Vue from 'vue'            \nimport Page from './pages/search/search.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./search.vue?vue&type=template&id=df6de348&\"\nvar renderjs\nimport script from \"./search.vue?vue&type=script&lang=js&\"\nexport * from \"./search.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"D:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('df6de348')) {\n      api.createRecord('df6de348', component.options)\n    } else {\n      api.reload('df6de348', component.options)\n    }\n    module.hot.accept(\"./search.vue?vue&type=template&id=df6de348&\", function () {\n      api.rerender('df6de348', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"E:/项目/HBuilderProjects/社区交友/pages/search/search.vue\"\nexport default component.exports","export * from \"-!D:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./search.vue?vue&type=template&id=df6de348&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./search.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./search.vue?vue&type=script&lang=js&\"","//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n\r\nimport commonList from '@/components/common/common-list.vue';\r\nimport topicList from '@/components/news/topic-list.vue';\r\nimport userList from '@/components/user-list/user-list.vue';\r\nimport loadMore from '@/components/common/loadmore.vue';\r\nexport default {\r\n\tcomponents: {\r\n\t\tcommonList,\r\n\t\ttopicList,\r\n\t\tuserList,\r\n\t\tloadMore\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tsearchText: '',\r\n\t\t\tlist: [],\r\n\t\t\t// 搜索结果\r\n\t\t\tsearchList: [],\r\n\t\t\t// 当前搜索类型\r\n\t\t\ttype: 'post',\r\n\t\t\tloadmore: '上拉加载更多',\r\n\t\t\tpage: 1\r\n\t\t};\r\n\t},\r\n\t// 监听导航输入\r\n\tonNavigationBarSearchInputChanged(e) {\r\n\t\tthis.searchText = e.text;\r\n\t},\r\n\t// 监听点击导航搜索按钮\r\n\tonNavigationBarButtonTap(e) {\r\n\t\tif (e.index === 0) {\r\n\t\t\tthis.searchEvent();\r\n\t\t}\r\n\t},\r\n\tonLoad(e) {\r\n\t\tif (e.type) {\r\n\t\t\tthis.type = e.type;\r\n\t\t}\r\n\t\tlet pageTitle = '帖子';\r\n\t\tswitch (this.type) {\r\n\t\t\tcase 'post':\r\n\t\t\t\tpageTitle = '帖子';\r\n\t\t\t\t// 监听关注和顶踩操作\r\n\t\t\t\tuni.$on('updateFollowOrSupport', e => {\r\n\t\t\t\t\tswitch (e.type) {\r\n\t\t\t\t\t\tcase 'follow': // 关注\r\n\t\t\t\t\t\t\tthis.follow(e.data.user_id);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'topic':\r\n\t\t\t\tpageTitle = '话题';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'user':\r\n\t\t\t\tpageTitle = '用户';\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\t// 修改搜索占位\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\t// 取出搜索历史\r\n\t\tlet list = uni.getStorageSync('historySeachText');\r\n\t\tif (list) {\r\n\t\t\tthis.list = JSON.parse(list);\r\n\t\t}\r\n\t},\r\n\tonUnload() {\r\n\t\tif (this.type === 'post') {\r\n\t\t\tuni.$off('updateFollowOrSupport', e => {});\r\n\t\t}\r\n\t},\r\n\t// 监听下拉刷新\r\n\tonPullDownRefresh() {\r\n\t\tif (this.searchText === '') {\r\n\t\t\treturn uni.stopPullDownRefresh();\r\n\t\t}\r\n\t\tthis.getData(true, () => {\r\n\t\t\t// 关闭下拉刷新状态\r\n\t\t\tuni.stopPullDownRefresh();\r\n\t\t});\r\n\t},\r\n\t// 监听上拉加载\r\n\tonReachBottom() {\r\n\t\tif (this.loadmore !== '上拉加载更多') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.loadmore = '加载中...';\r\n\t\tthis.getData(false);\r\n\t},\r\n\tmethods: {\r\n\t\t// 关注\r\n\t\tfollow(user_id) {\r\n\t\t\t// 找到当前作者的所有列表\r\n\t\t\tthis.searchList.forEach(item => {\r\n\t\t\t\tif (item.user_id === user_id) {\r\n\t\t\t\t\titem.isFollow = true;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tuni.showToast({ title: '关注成功' });\r\n\t\t},\r\n\t\t// 顶踩操作\r\n\t\tdoSupport(e) {\r\n\t\t\t// 拿到当前的选项卡对应的list\r\n\t\t\tthis.searchList.forEach(item => {\r\n\t\t\t\tif (item.id === e.id) {\r\n\t\t\t\t\t// 之前没有操作过\r\n\t\t\t\t\tif (item.support.type === '') {\r\n\t\t\t\t\t\titem.support[e.type + '_count']++;\r\n\t\t\t\t\t} else if (item.support.type === 'support' && e.type === 'unsupport') {\r\n\t\t\t\t\t\t// 顶 - 1\r\n\t\t\t\t\t\titem.support.support_count--;\r\n\t\t\t\t\t\t// 踩 + 1\r\n\t\t\t\t\t\titem.support.unsupport_count++;\r\n\t\t\t\t\t} else if (item.support.type === 'unsupport' && e.type === 'support') {\r\n\t\t\t\t\t\t// 之前踩了\r\n\t\t\t\t\t\t// 顶 + 1\r\n\t\t\t\t\t\titem.support.support_count++;\r\n\t\t\t\t\t\t// 踩 - 1\r\n\t\t\t\t\t\titem.support.unsupport_count--;\r\n\t\t\t\t\t}\r\n\t\t\t\t\titem.support.type = e.type;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tlet msg = e.type === 'support' ? '顶' : '踩';\r\n\t\t\tuni.showToast({ title: msg + '成功' });\r\n\t\t},\r\n\t\t// 点击搜索历史\r\n\t\tclickSearchHistory(text) {\r\n\t\t\tthis.searchText = text;\r\n\t\t\tthis.searchEvent();\r\n\t\t},\r\n\t\t// 搜索事件\r\n\t\tsearchEvent() {\r\n\t\t\t// 收起键盘\r\n\t\t\tuni.hideKeyboard();\r\n\t\t\t// 加入搜索历史\r\n\t\t\tlet index = this.list.findIndex(v => v === this.searchText);\r\n\t\t\tif (index !== -1) {\r\n\t\t\t\tthis.$U.__toFirst(this.list, index);\r\n\t\t\t} else {\r\n\t\t\t\tthis.list.unshift(this.searchText);\r\n\t\t\t}\r\n\t\t\tuni.setStorageSync('historySeachText', JSON.stringify(this.list));\r\n\t\t\t// 请求搜索\r\n\t\t\tthis.getData();\r\n\t\t},\r\n\t\t// 获取数据\r\n\t\tgetData(isrefresh = true, callback = false) {\r\n\t\t\t// 显示loading状态\r\n\t\t\tuni.showLoading({\r\n\t\t\t\ttitle: '加载中...',\r\n\t\t\t\tmask: false\r\n\t\t\t});\r\n\t\t\t// 请求搜索\r\n\t\t\tthis.page = isrefresh ? 1 : this.page + 1;\r\n\t\t\tthis.$H\r\n\t\t\t\t.post('/search/' + this.type, {\r\n\t\t\t\t\tkeyword: this.searchText,\r\n\t\t\t\t\tpage: this.page\r\n\t\t\t\t})\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\t// 整理格式\r\n\t\t\t\t\tlet list = [];\r\n\t\t\t\t\tswitch (this.type) {\r\n\t\t\t\t\t\tcase 'post':\r\n\t\t\t\t\t\t\tlist = res.list.map(v => {\r\n\t\t\t\t\t\t\t\treturn this.$U.formatCommonList(v);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'topic':\r\n\t\t\t\t\t\t\tlist = res.list.map(v => {\r\n\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\tid: v.id,\r\n\t\t\t\t\t\t\t\t\tcover: v.titlepic,\r\n\t\t\t\t\t\t\t\t\ttitle: v.title,\r\n\t\t\t\t\t\t\t\t\tdesc: v.desc,\r\n\t\t\t\t\t\t\t\t\ttoday_count: v.todaypost_count,\r\n\t\t\t\t\t\t\t\t\tnews_count: v.post_count\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'user':\r\n\t\t\t\t\t\tlist = res.list.map(v => {\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\tid: v.id,\r\n\t\t\t\t\t\t\t\tavatar: v.userpic,\r\n\t\t\t\t\t\t\t\tusername: v.username,\r\n\t\t\t\t\t\t\t\tsex: v.userinfo.sex, //0:未知；1：女性；2：男性\r\n\t\t\t\t\t\t\t\tage: v.userinfo.age,\r\n\t\t\t\t\t\t\t    isFollow: false\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 渲染页面\r\n\t\t\t\t\tthis.searchList = isrefresh ? [...list] : [...this.searchList, ...list];\r\n\t\t\t\t\t// 加载情况\r\n\t\t\t\t\tthis.loadmore = list.length < 10 ? '没有更多了' : '上拉加载更多';\r\n\t\t\t\t\t//隐藏loading\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\tif (typeof callback === 'function') {\r\n\t\t\t\t\t\tcallback();\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.catch(err => {\r\n\t\t\t\t\tthis.page--;\r\n\t\t\t\t\t//隐藏loading\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\tif (typeof callback === 'function') {\r\n\t\t\t\t\t\tcallback();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t}\r\n\t}\r\n};\r\n"],"sourceRoot":""}